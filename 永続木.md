[[連想配列]]の亜種的な存在
過去の情報を上書きせずに新たな情報の登録(=gitのcommitのような操作)を可能とさせるデータ構造
pushに場所を指定できる
既存のindexの更新に削除や値の更新はせず、対応index ptrの更新と追加挿入のみを行う
ptrの向きは　root <- child

~~~cpp
template <typename S> class PersistentStack {
private:
	struct Node {
		S val;
		Node *pre;
	};
	using NP = Node *;

public:
	NP root;
	PersistentStack() : root(new Node(S{}, nullptr)) {
		root->pre = root;
	}
	NP push(NP ptr, const S &val) const { return new Node(val, ptr); }
	S top(NP ptr) const { return ptr->val; }
	NP pop(NP ptr) const { return ptr->pre; }
};

int32_t main() {
	PersistentStack<int> ps;
	auto now = ps.root;
	map<int, decltype(now)> mp; //これでindex vs ptrを管理
	return 0;
}
~~~